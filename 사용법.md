# 미디어 자막 인덱서 사용법

## 개요

이 프로그램은 지정된 디렉토리에서 미디어 파일을 찾아 해당 영어 자막(.srt)을 인덱싱하여 검색 가능한 데이터베이스를 구축합니다.

## 시작하기

### 환경 준비

1. Python 가상환경을 활성화합니다:
   ```bash
   # 가상환경이 없는 경우 생성
   python -m venv venv
   
   # 가상환경 활성화
   # Windows의 경우
   venv\Scripts\activate
   
   # macOS/Linux의 경우
   source venv/bin/activate
   ```

2. 필요한 패키지 설치:
   ```bash
   pip install -r requirements.txt
   ```

### 서버 실행

```bash
python main.py
```

서버가 시작되면 `http://localhost:8080`으로 접속할 수 있습니다.

## 주요 기능

### 1. 미디어 인덱싱

- **경로**: `/` 또는 `/indexing-process`
- **설명**: 지정된 루트 디렉토리에서 미디어 파일과 자막을 스캔하여 데이터베이스에 저장합니다.
- **사용 방법**:
  1. 설정 페이지에서 미디어 폴더 경로를 확인/설정
  2. "인덱싱 시작" 버튼 클릭
  3. 인덱싱 과정을 실시간으로 모니터링

### 2. 자막 검색

- **경로**: `/search`
- **설명**: 인덱싱된 자막에서 텍스트를 검색합니다.
- **사용 방법**:
  1. 검색어 입력
  2. 검색 결과에서 미디어 파일 및 해당 자막 확인
  3. 타임코드를 클릭하여 해당 시점부터 미디어 재생 가능

### 3. 설정 관리

- **경로**: `/settings`
- **설명**: 애플리케이션 설정을 구성합니다.
- **설정 항목**:
  - **루트 디렉토리**: 미디어 파일을 스캔할 기본 디렉토리
  - **미디어 확장자**: 인식할 미디어 파일 확장자 (기본값: .mp4, .mkv, .avi, .mov, .wmv)
  - **최대 스레드 수**: 인덱싱 성능 조절

## 고급 기능

### 증분 인덱싱

이미 인덱싱된 파일을 건너뛰고 새로 추가된 파일만 인덱싱합니다. 기본적으로 활성화되어 있으며, 설정에서 비활성화할 수 있습니다.

### 데이터베이스 관리

- 기본 데이터베이스 위치: `media_index.db`
- 데이터베이스 초기화 옵션: 인덱싱 시작 시 "DB 초기화" 옵션 체크

## 검색 기능 사용법

### 검색 기능
1. 검색창에 검색할 단어를 입력하고 검색 버튼을 클릭합니다.
2. 검색 결과에는 해당 단어가 포함된 자막들이 파일별로 구분되어 표시됩니다.
3. 자막을 클릭하면 해당 부분의 비디오가 재생됩니다.

### 재생 모드
- **검색 결과만**: 검색 결과에 나온 자막들만 순서대로 재생합니다.
- **순차 재생**: 검색 결과를 포함한 전체 자막을 시간 순서대로 재생합니다.
- **랜덤 재생**: 자막을 무작위로 재생합니다.
- **한 부분 반복**: 현재 자막을 반복 재생합니다.

### 북마크 및 태그 기능
- **북마크**: 자막 옆의 ☆ 버튼을 클릭하면 해당 자막을 북마크할 수 있습니다.
- **태그**: 자막 옆의 🏷️ 버튼을 클릭하면 태그를 추가할 수 있습니다.
- **북마크만 보기**: 화면 상단의 '북마크만 보기' 버튼을 클릭하면 북마크된 자막만 표시됩니다.

### 재생 제어
- **이전/다음 영상**: 이전 또는 다음 영상으로 이동합니다.
- **이전/다음 문장**: 이전 또는 다음 자막으로 이동합니다.
- **반복**: 현재 자막을 설정한 횟수만큼 반복 재생합니다.

## 자주 발생하는 문제와 해결 방법

### 비디오가 재생되지 않는 경우
- 브라우저의 자동 재생 정책으로 인해 발생할 수 있습니다. 화면에 나타나는 '재생' 버튼을 클릭하세요.
- 자막을 다시 클릭해보세요.
- 페이지를 새로고침한 후 다시 시도해보세요.

### 검색 결과가 표시되지 않는 경우
- 검색어를 다시 확인하세요.
- 서버가 실행 중인지 확인하세요.
- 브라우저 콘솔에 오류 메시지가 있는지 확인하세요 (F12 키를 눌러 개발자 도구 열기).

## 개발자 정보

로그 파일:
- `database_debug.log`: 데이터베이스 관련 디버그 로그
- `database_verbose.log`: 상세한 데이터베이스 작업 로그
- `api_docs_generator.log`: API 문서 생성 관련 로그

소스 코드 및 추가 정보는 PROGRESS.md 파일을 참조하세요. 